<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../layout/customerTemplate.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html">

    <ui:define name="top">
        Hidden Gem
    </ui:define>

    <ui:define name="content">

        <h:form id="form">

            <p:growl id="growl" showDetail="true" sticky="true" />

            <p:dataView widgetVar="viewHiddenGems"
                        var="hiddenGem"
                        value="#{hiddenGemManagedBean.hiddenGems}">

                <f:facet name="header" >

                    <p:outputPanel style="display: flex; justify-content: space-between; padding: 5px;">

                        <p:outputPanel>
                            <h:outputText value="Search: " />
                            <h:selectOneMenu value="#{hiddenGemManagedBean.searchType}">
                                <f:selectItem itemValue="PLACE" itemLabel="Place" />
                                <f:selectItem itemValue="POSTAL CODE" itemLabel="Postal Code" />

                            </h:selectOneMenu>
                            <p:inputText
                                placeholder="Enter keywords"
                                value="#{hiddenGemManagedBean.searchString}">
                            </p:inputText>

                            <p:outputPanel>
                                <h:outputLabel for="filter" value="Districts:" />
                                <p:selectCheckboxMenu id="filter" value="#{hiddenGemManagedBean.selectedDistricts}" multiple="true"
                                                      filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
                                    <p:ajax event="itemUnselect" listener="#{hiddenGemManagedBean.onItemUnselect}" />
                                    <f:selectItems value="#{hiddenGemManagedBean.districts}" />
                                </p:selectCheckboxMenu>
                                <p:commandButton
                                    value ="Search"
                                    action="#{hiddenGemManagedBean.filter}"
                                    update="form"
                                    />
                            </p:outputPanel>
                        </p:outputPanel>


                        <p:outputPanel style="text-align: right; font-size: 16px">
                            <p:commandButton value="Add Hidden Gem" action="addHiddenGem.xhtml" />
                        </p:outputPanel>
                    </p:outputPanel>
                </f:facet>

                <p:dataViewListItem>
                    <p:outputPanel style="size: auto; position:relative; border: 1px solid #ccc; border-radius: 5px; padding: 10px">
                        <h:panelGrid columns="1" style="width:100%; align-content: center; size: auto">

                            <h:outputText value="Place: #{hiddenGem.placeName}" />

                            <h:panelGroup layout="inline">
                                <h:outputLabel>Postal Code: </h:outputLabel>
                                <h:outputText value="#{hiddenGem.postalCode}" />
                            </h:panelGroup>

                            <h:panelGroup layout="inline">
                                <h:outputLabel>District: </h:outputLabel>
                                <h:outputText value="#{hiddenGem.district}" />
                            </h:panelGroup>

                            <h:panelGroup layout="inline">
                                <h:outputLabel>First Added on: </h:outputLabel>
                                <h:outputText value="#{hiddenGem.created}">
                                    <f:convertDateTime type="date" pattern="dd/MM/yyyy" />
                                </h:outputText>
                            </h:panelGroup>

                            <p:commandButton value="View All Reviews"
                                             action="hiddenGemReviews.xhtml"
                                             update=":form">
                                <f:param name="hgId" value="#{hiddenGem.id}" />
                            </p:commandButton>

                        </h:panelGrid>
                    </p:outputPanel>
                </p:dataViewListItem>
            </p:dataView>
        </h:form>
    </ui:define>

</ui:composition>
